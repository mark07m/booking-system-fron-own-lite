# Настройка CI/CD

## Проблемы, которые были исправлены

### 1. Версия Node.js
- **Проблема**: CI использовал Node.js 20.19.5, а требовался 19.9.0
- **Решение**: Обновлены все workflow файлы для использования Node.js 19.9.0

### 2. Обнаружение файла блокировки зависимостей
- **Проблема**: GitHub Actions не мог найти файл блокировки зависимостей
- **Решение**: Настроена правильная работа с `pnpm-lock.yaml` через `pnpm/action-setup@v4`

## Файлы, которые были созданы/обновлены

### GitHub Actions Workflows
- `.github/workflows/ci.yml` - Основной CI pipeline
- `.github/workflows/deploy.yml` - Деплой в продакшн
- `.github/workflows/quality.yml` - Проверка качества кода (обновлен)
- `.github/workflows/security.yml` - Проверка безопасности (обновлен)
- `.github/workflows/test.yml` - Тестирование (обновлен)

### Конфигурационные файлы
- `.nvmrc` - Версия Node.js для nvm
- `.node-version` - Версия Node.js для nodenv
- `package.json` - Обновлена минимальная версия Node.js

## Настройка секретов GitHub

Для работы деплоя необходимо добавить следующие секреты в настройках репозитория:

1. `VERCEL_TOKEN` - Токен Vercel
2. `VERCEL_ORG_ID` - ID организации Vercel
3. `VERCEL_PROJECT_ID` - ID проекта Vercel

## Команды для локальной проверки

```bash
# Проверка качества кода
pnpm run quality

# Проверка безопасности
pnpm run security:audit

# Запуск тестов
pnpm run test:ci

# Сборка проекта
pnpm run build
```

## Структура CI Pipeline

1. **Quality Check** - Линтинг, проверка типов, тесты
2. **Build** - Сборка приложения
3. **Security Check** - Проверка безопасности
4. **Deploy** - Деплой в продакшн (только для main ветки)

## Особенности настройки

- Используется pnpm как менеджер пакетов
- Кэширование зависимостей для ускорения сборки
- Матричная сборка для проверки совместимости
- Автоматический деплой при пуше в main ветку
